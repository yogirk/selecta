{"ast":null,"code":"import'./DataPreview.css';import React,{useState,useEffect}from'react';import{CircleLoader}from'react-spinners';// Changed from ScaleLoader to CircleLoader\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const DataPreview=()=>{const[cardsData,setCardsData]=useState([{title:'Total Tables',value:'Loading...',trend:''},{title:'Total Columns',value:'Loading...',trend:''},{title:'Total Rows',value:'Loading...',trend:''}]);const[tables,setTables]=useState([]);const[tableData,setTableData]=useState({});const[openAccordion,setOpenAccordion]=useState(null);const[loadingTables,setLoadingTables]=useState(true);const[loadingTableData,setLoadingTableData]=useState({});useEffect(()=>{setLoadingTables(true);fetch('/api/tables').then(response=>response.json()).then(data=>{setTables(data.tables);setCardsData([{title:'Total Tables',value:data.num_tables,trend:''},{title:'Total Columns',value:data.total_columns,trend:''},{title:'Total Rows',value:data.total_rows,trend:''}]);setLoadingTables(false);}).catch(error=>{console.error(\"Error fetching tables:\",error);setTables([]);setLoadingTables(false);});},[]);const toggleAccordion=async tableName=>{if(openAccordion===tableName){setOpenAccordion(null);return;}setOpenAccordion(tableName);setLoadingTableData(prev=>({...prev,[tableName]:true}));try{const response=await fetch(`/api/table_data?table_name=${tableName}`);const data=await response.json();setTableData(prevData=>{const newTableData={...prevData};newTableData[tableName]=data;return newTableData;});}catch(error){console.error(\"Error fetching table data:\",error);setTableData(prevData=>({...prevData,[tableName]:{error:\"Failed to load data\"}}));}finally{setLoadingTableData(prev=>({...prev,[tableName]:false}));}};return/*#__PURE__*/_jsxs(\"div\",{className:\"data-preview-page\",children:[/*#__PURE__*/_jsx(\"header\",{className:\"page-header\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"BigQuery Dataset Preview\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"cards-container\",children:cardsData.map((card,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"data-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:card.title}),/*#__PURE__*/_jsx(\"p\",{className:\"card-value\",children:card.value==='Loading...'?/*#__PURE__*/_jsx(CircleLoader,{color:\"#36D7B7\",size:20}):card.value}),/*#__PURE__*/_jsx(\"p\",{className:\"card-trend\",children:card.trend})]},index))}),/*#__PURE__*/_jsxs(\"div\",{className:\"accordion-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"BigQuery Dataset\"}),loadingTables?/*#__PURE__*/_jsxs(\"div\",{className:\"spinner-container\",children:[/*#__PURE__*/_jsx(CircleLoader,{color:\"#36D7B7\",size:30}),\" \"]}):tables.map(tableName=>/*#__PURE__*/_jsxs(\"div\",{className:`accordion-item ${openAccordion===tableName?'open':''}`,children:[/*#__PURE__*/_jsxs(\"button\",{className:\"accordion-header\",onClick:()=>toggleAccordion(tableName),children:[/*#__PURE__*/_jsx(\"span\",{children:tableName}),/*#__PURE__*/_jsx(\"span\",{children:openAccordion===tableName?'-':'+'})]}),openAccordion===tableName&&/*#__PURE__*/_jsx(\"div\",{className:\"accordion-content\",children:loadingTableData[tableName]?/*#__PURE__*/_jsxs(\"div\",{className:\"spinner-container\",children:[/*#__PURE__*/_jsx(CircleLoader,{color:\"#36D7B7\",size:20}),\" \"]}):tableData[tableName]?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"metadata-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Metadata:\"}),tableData[tableName].error?/*#__PURE__*/_jsx(\"p\",{children:\"Error loading metadata.\"}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Description:\"}),\" \",tableData[tableName].description]})})]}),/*#__PURE__*/_jsx(\"h4\",{children:\"Table Data:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",children:/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsx(\"tr\",{children:tableData[tableName].data&&tableData[tableName].data.length>0&&Object.keys(tableData[tableName].data[0]).map(col=>/*#__PURE__*/_jsx(\"th\",{children:col},col))})}),/*#__PURE__*/_jsx(\"tbody\",{children:tableData[tableName].data&&tableData[tableName].data.map((row,rowIndex)=>/*#__PURE__*/_jsx(\"tr\",{children:Object.values(row).map((value,colIndex)=>/*#__PURE__*/_jsx(\"td\",{children:String(value)},colIndex))},rowIndex))})]})})]}):/*#__PURE__*/_jsx(\"p\",{children:\"Loading data...\"})})]},tableName))]})]});};export default DataPreview;","map":{"version":3,"names":["React","useState","useEffect","CircleLoader","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","DataPreview","cardsData","setCardsData","title","value","trend","tables","setTables","tableData","setTableData","openAccordion","setOpenAccordion","loadingTables","setLoadingTables","loadingTableData","setLoadingTableData","fetch","then","response","json","data","num_tables","total_columns","total_rows","catch","error","console","toggleAccordion","tableName","prev","prevData","newTableData","className","children","map","card","index","color","size","onClick","description","length","Object","keys","col","row","rowIndex","values","colIndex","String"],"sources":["/Users/rk/Documents/Projects/conv-analytics-demo/frontend/src/components/DataPreview/DataPreview.js"],"sourcesContent":["import './DataPreview.css';\n\nimport React, { useState, useEffect } from 'react';\nimport { CircleLoader } from 'react-spinners'; // Changed from ScaleLoader to CircleLoader\n\nconst DataPreview = () => {\n  const [cardsData, setCardsData] = useState([\n    { title: 'Total Tables', value: 'Loading...', trend: '' },\n    { title: 'Total Columns', value: 'Loading...', trend: '' },\n    { title: 'Total Rows', value: 'Loading...', trend: '' },\n  ]);\n  const [tables, setTables] = useState([]);\n  const [tableData, setTableData] = useState({});\n  const [openAccordion, setOpenAccordion] = useState(null);\n  const [loadingTables, setLoadingTables] = useState(true);\n  const [loadingTableData, setLoadingTableData] = useState({});\n\n  useEffect(() => {\n    setLoadingTables(true);\n    fetch('/api/tables')\n      .then(response => response.json())\n      .then(data => {\n        setTables(data.tables);\n        setCardsData([\n          { title: 'Total Tables', value: data.num_tables, trend: '' },\n          { title: 'Total Columns', value: data.total_columns, trend: '' },\n          { title: 'Total Rows', value: data.total_rows, trend: '' },\n        ]);\n        setLoadingTables(false);\n      })\n      .catch(error => {\n        console.error(\"Error fetching tables:\", error);\n        setTables([]);\n        setLoadingTables(false);\n      });\n  }, []);\n\n  const toggleAccordion = async (tableName) => {\n    if (openAccordion === tableName) {\n      setOpenAccordion(null);\n      return;\n    }\n\n    setOpenAccordion(tableName);\n\n    setLoadingTableData(prev => ({ ...prev, [tableName]: true }));\n    try {\n      const response = await fetch(`/api/table_data?table_name=${tableName}`);\n      const data = await response.json();\n      setTableData(prevData => {\n        const newTableData = { ...prevData };\n        newTableData[tableName] = data;\n        return newTableData;\n      });\n    } catch (error) {\n      console.error(\"Error fetching table data:\", error);\n      setTableData(prevData => ({\n        ...prevData,\n        [tableName]: { error: \"Failed to load data\" }\n      }));\n    } finally {\n      setLoadingTableData(prev => ({ ...prev, [tableName]: false }));\n    }\n  };\n\n  return (\n    <div className=\"data-preview-page\">\n      <header className=\"page-header\">\n        <h1>BigQuery Dataset Preview</h1>\n      </header>\n      <div className=\"cards-container\">\n        {cardsData.map((card, index) => (\n          <div key={index} className=\"data-card\">\n            <h3>{card.title}</h3>\n            <p className=\"card-value\">\n              {card.value === 'Loading...' ? <CircleLoader color=\"#36D7B7\" size={20} /> : card.value}\n            </p>\n            <p className=\"card-trend\">{card.trend}</p>\n          </div>\n        ))}\n      </div>\n\n      <div className=\"accordion-container\">\n        <h2>BigQuery Dataset</h2>\n        {loadingTables ? (\n          <div className=\"spinner-container\">\n            <CircleLoader color=\"#36D7B7\" size={30} /> {/* Changed to CircleLoader, added size prop */}\n          </div>\n        ) : (\n          tables.map((tableName) => (\n            <div key={tableName} className={`accordion-item ${openAccordion === tableName ? 'open' : ''}`}>\n              <button\n                className=\"accordion-header\"\n                onClick={() => toggleAccordion(tableName)}\n              >\n                <span>{tableName}</span>\n                <span>{openAccordion === tableName ? '-' : '+'}</span>\n              </button>\n              {openAccordion === tableName && (\n                <div className=\"accordion-content\">\n                  {loadingTableData[tableName] ? (\n                    <div className=\"spinner-container\">\n                      <CircleLoader color=\"#36D7B7\" size={20} /> {/* Changed to CircleLoader, added size prop */}\n                    </div>\n                  ) : tableData[tableName] ? (\n                    <>\n                      <div className=\"metadata-section\">\n                        <h4>Metadata:</h4>\n                        {tableData[tableName].error ? (\n                          <p>Error loading metadata.</p>\n                        ) : (\n                          <>\n                            <p><strong>Description:</strong> {tableData[tableName].description}</p>\n                          </>\n                        )}\n                      </div>\n                      <h4>Table Data:</h4>\n                      <div className=\"table-responsive\">\n                        <table>\n                          <thead>\n                            <tr>\n                              {tableData[tableName].data && tableData[tableName].data.length > 0 &&\n                                Object.keys(tableData[tableName].data[0]).map(col => (\n                                  <th key={col}>{col}</th>\n                                ))}\n                            </tr>\n                          </thead>\n                          <tbody>\n                            {tableData[tableName].data && tableData[tableName].data.map((row, rowIndex) => (\n                              <tr key={rowIndex}>\n                                {Object.values(row).map((value, colIndex) => (\n                                  <td key={colIndex}>{String(value)}</td>\n                                ))}\n                              </tr>\n                            ))}\n                          </tbody>\n                        </table>\n                      </div>\n                    </>\n                  ) : (\n                    <p>Loading data...</p>\n                  )}\n                </div>\n              )}\n            </div>\n          ))\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default DataPreview;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}